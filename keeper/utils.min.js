var sjcl=require("sjcl"),PBKDF2=function(r,t){return sjcl.misc.pbkdf2(r,t,5e4)},HMAC=function(r,t){return new sjcl.misc.hmac(r).encrypt(t)},SHA256=function(r){return sjcl.hash.sha256.hash(r)},setupCipher=function(r){if(128===getBitArrayLength(r))return new sjcl.cipher.aes(r);throw"setupCipher: only accepts keys for AES-128"},encryptWithGCM=function(r,t,e){var n=randomBitArray(128),i=sjcl.mode.gcm.encrypt(r,t,n,e);return sjcl.bitArray.concat(n,i)},decryptWithGCM=function(r,t,e){var n=sjcl.bitArray.bitSlice(t,0,128),i=sjcl.bitArray.bitSlice(t,128);return sjcl.mode.gcm.decrypt(r,i,n,e)},bitArraySlice=function(r,r,t){return sjcl.bitArray.bitSlice(r,r,t)},bitArrayToString=function(r){return sjcl.codec.utf8String.fromBits(r)},stringToBitArray=function(r){return sjcl.codec.utf8String.toBits(r)},bitArrayToHex=function(r){return sjcl.codec.hex.fromBits(r)},hexToBitArray=function(r){return sjcl.codec.hex.toBits(r)},bitArrayToBase64=function(r){return sjcl.codec.base64.fromBits(r)},base64ToBitArray=function(r){return sjcl.codec.base64.toBits(r)},byteArrayToHex=function(r){for(var t="",e=0;e<r.length;e++){if(r[e]<0||r[e]>=256)throw"Value out of byte range";t+=(256+(0|r[e])).toString(16).substr(1)}return t},hexToByteArray=function(r){var t=[];if(r.length%2!=0)throw"String has odd length";for(var e=0;e<r.length;e+=2)t.push(0|parseInt(r.substr(e,2),16));return t},wordToBytesAcc=function(r,t){if(r<0)throw"Is negative integer";for(var e=0;e<4;e++)t.push(255&r),r>>>=8},wordFromBytesSub=function(r,t){if(!Array.isArray(r))throw"Bytes is non-array";if(r.length<4)throw"Bytes is a too short array";for(var e=0,n=t+3;n>=t;n--)e<<=8,e|=r[n];return e},stringToPaddedByteArray=function(r,t){if("string"!=typeof r)throw"Non-string value";var e=unescape(encodeURIComponent(r)),n=e.length;if(n>t)throw"String is too long";var i=[];wordToBytesAcc(n,i);for(var o=0;o<t;o++)o<n?i.push(e.charCodeAt(o)):i.push(0);return i},stringToPaddedBitArray=function(r,t){return sjcl.codec.hex.toBits(byteArrayToHex(stringToPaddedByteArray(r,t)))},paddedByteArrayToString=function(r,t){if(r.length!=t+4)throw"Wrong length";for(var e=wordFromBytesSub(r,0),n="",i=4;i<Math.min(4+e,r.length);i++)n+=String.fromCharCode(r[i]);return decodeURIComponent(escape(n))},paddedBitArrayToString=function(r,t){return paddedByteArrayToString(hexToByteArray(sjcl.codec.hex.fromBits(r)),t)},randomBitArray=function(r){if(r%32==0)return sjcl.random.randomWords(r/32,0);throw"Length not divisible by 32"},compareBitArrays=function(r,t){return sjcl.bitArray.equal(r,t)},getBitArrayLength=function(r){return sjcl.bitArray.bitLength(r)},concatBitArray=function(r,t){return sjcl.bitArray.concat(r,t)},objectHasKey=function(r,t){return r.hasOwnProperty(t)};module.exports={PBKDF2:PBKDF2,HMAC:HMAC,SHA256:SHA256,setupCipher:setupCipher,encryptwithGCM:encryptWithGCM,decryptWithGCM:decryptWithGCM,bitArraySlice:bitArraySlice,bitArrayToString:bitArrayToString,stringToBitArray:stringToBitArray,bitArrayToBase64:bitArrayToBase64,base64ToBitArray:base64ToBitArray,stringToPaddedBitArray:stringToPaddedBitArray,paddedBitArrayToString:paddedBitArrayToString,randomBitArray:randomBitArray,compareBitArrays:compareBitArrays,getBitArrayLength:getBitArrayLength,concatBitArray:concatBitArray,objectHasKey:objectHasKey,bitArrayToHex:bitArrayToHex,hexToBitArray:hexToBitArray};